import{c as Y,r as h,j as e,P as de,a as me,B as G,C as ue,f as J,b as xe,d as pe,e as O,s as q,g as he,h as fe,L as ge,i as je,p as be,k as ye,l as Ne,A as ve,u as we,m as Se,D as Le,n as _,o as C,F as I,U as V,q as F,t as B,v as Ee,S as M,w as H,x as U,y as P,z as N,E as _e,G as Ce}from"./index-CRE_jXCn.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=Y("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=Y("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),De=({value:x,onChange:c})=>{const[i,m]=h.useState(!1);return e.jsxs(de,{open:i,onOpenChange:m,children:[e.jsx(me,{asChild:!0,children:e.jsxs(G,{variant:"outline",className:"w-[220px] justify-start text-left font-normal",children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),x!=null&&x.from&&(x!=null&&x.to)?`${J(x.from,"dd/MM/yyyy")} - ${J(x.to,"dd/MM/yyyy")}`:"เลือกช่วงวันที่"]})}),e.jsx(xe,{className:"w-auto p-0",align:"start",children:e.jsx(pe,{mode:"range",selected:x,onSelect:c,initialFocus:!0})})]})};var ee={exports:{}};(function(x,c){(function(i,m){m()})(O,function(){function i(s,l){return typeof l>"u"?l={autoBom:!1}:typeof l!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}function m(s,l,b){var o=new XMLHttpRequest;o.open("GET",s),o.responseType="blob",o.onload=function(){u(o.response,l,b)},o.onerror=function(){console.error("could not download file")},o.send()}function v(s){var l=new XMLHttpRequest;l.open("HEAD",s,!1);try{l.send()}catch{}return 200<=l.status&&299>=l.status}function p(s){try{s.dispatchEvent(new MouseEvent("click"))}catch{var l=document.createEvent("MouseEvents");l.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),s.dispatchEvent(l)}}var r=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof O=="object"&&O.global===O?O:void 0,f=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),u=r.saveAs||(typeof window!="object"||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!f?function(s,l,b){var o=r.URL||r.webkitURL,n=document.createElement("a");l=l||s.name||"download",n.download=l,n.rel="noopener",typeof s=="string"?(n.href=s,n.origin===location.origin?p(n):v(n.href)?m(s,l,b):p(n,n.target="_blank")):(n.href=o.createObjectURL(s),setTimeout(function(){o.revokeObjectURL(n.href)},4e4),setTimeout(function(){p(n)},0))}:"msSaveOrOpenBlob"in navigator?function(s,l,b){if(l=l||s.name||"download",typeof s!="string")navigator.msSaveOrOpenBlob(i(s,b),l);else if(v(s))m(s,l,b);else{var o=document.createElement("a");o.href=s,o.target="_blank",setTimeout(function(){p(o)})}}:function(s,l,b,o){if(o=o||open("","_blank"),o&&(o.document.title=o.document.body.innerText="downloading..."),typeof s=="string")return m(s,l,b);var n=s.type==="application/octet-stream",y=/constructor/i.test(r.HTMLElement)||r.safari,w=/CriOS\/[\d]+/.test(navigator.userAgent);if((w||n&&y||f)&&typeof FileReader<"u"){var g=new FileReader;g.onloadend=function(){var L=g.result;L=w?L:L.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=L:location=L,o=null},g.readAsDataURL(s)}else{var E=r.URL||r.webkitURL,j=E.createObjectURL(s);o?o.location=j:location.href=j,o=null,setTimeout(function(){E.revokeObjectURL(j)},4e4)}});r.saveAs=u.saveAs=u,x.exports=u})})(ee);var Te=ee.exports;async function $e(){const{data:x,error:c}=await q.from("Employee").select("id, Name, Team").order("Name",{ascending:!0});if(c)throw c;return x}const Fe=async x=>{const{data:c,error:i}=await q.from("Employee").select("*").eq("id",x).single();if(i||!c)throw i||new Error("Employee not found");const m=[];if(c.budget_wedding!==null&&c.budget_wedding!==void 0){const r=c.budget_wedding,f=3e3-r;m.push({type:"wedding",totalLimit:3e3,used:f,remaining:r})}if(c.Budget_Training!==null&&c.Budget_Training!==void 0){const p=c.Original_Budget_Training||1e4,r=c.Budget_Training,f=p-r;m.push({type:"training",totalLimit:p,used:f,remaining:r})}if(c.budget_dentalglasses!==null&&c.budget_dentalglasses!==void 0){const r=c.budget_dentalglasses,f=2e3-r;m.push({type:"dental",totalLimit:2e3,used:f,remaining:r})}if(c.budget_medical!==null&&c.budget_medical!==void 0){const r=c.budget_medical,f=1e3-r;m.push({type:"medical",totalLimit:1e3,used:f,remaining:r})}if(c.budget_fitness!==null&&c.budget_fitness!==void 0){const r=c.budget_fitness,f=300-r;m.push({type:"fitness",totalLimit:300,used:f,remaining:r})}return[{type:"childbirth",totalLimit:8e3},{type:"funeral",totalLimit:1e4}].forEach(p=>{m.some(f=>f.type===p.type)||m.push({type:p.type,totalLimit:p.totalLimit,used:0,remaining:p.totalLimit})}),m},Be=({open:x,onClose:c,children:i})=>(h.useEffect(()=>{if(!x)return;const m=v=>{v.key==="Escape"&&c()};return window.addEventListener("keydown",m),()=>window.removeEventListener("keydown",m)},[x,c]),x?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:[e.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg relative w-full max-w-2xl mx-4 animate-fade-in",onClick:m=>m.stopPropagation(),role:"dialog","aria-modal":"true",children:i}),e.jsx("div",{className:"fixed inset-0 z-40",onClick:c,"aria-label":"Close modal background"})]}):null);he.register(fe,ge,je,be,ye,Ne,ve);const D={wedding:"ค่าแต่งงาน",training:"ค่าอบรม",childbirth:"ค่าคลอดบุตร",funeral:"ค่าช่วยเหลืองานศพ",glasses:"ค่าตัดแว่น",dental:"ค่าทำฟัน",fitness:"ค่าออกกำลังกาย",medical:"ค่ารักษาพยาบาล"};function Oe({summaryByType:x,statusSummary:c,departmentSummary:i,welfareTypeLabels:m,filteredRequests:v,employees:p,departmentFilter:r,employeeFilter:f,dateRange:u}){let s="";s+=`รายงานสรุปการใช้สวัสดิการ\r
`,s+=`วันที่สร้างรายงาน: ${new Date().toLocaleDateString("th-TH")}\r
`,u!=null&&u.from&&(u!=null&&u.to)&&(s+=`ช่วงเวลา: ${u.from.toLocaleDateString("th-TH")} - ${u.to.toLocaleDateString("th-TH")}\r
`),s+=`\r
`,r==="all"&&f==="all"&&(s+=`รายละเอียดการเบิกสวัสดิการของพนักงานทุกคน\r
`,s+=`ชื่อพนักงาน,แผนก,ค่าแต่งงาน,ค่าอบรม,ค่าคลอดบุตร,ค่าช่วยเหลืองานศพ,ค่าตัดแว่น,ค่าทำฟัน,ค่าออกกำลังกาย,ค่ารักษาพยาบาล,รวมทั้งหมด\r
`,[...p].sort((y,w)=>{const g=y.Team||"ไม่ระบุ",E=w.Team||"ไม่ระบุ";return g!==E?g.toLowerCase().includes("management")?-1:E.toLowerCase().includes("management")?1:g.localeCompare(E,"th"):(y.Name||"").localeCompare(w.Name||"","th")}).forEach(y=>{const w=v.filter(j=>j.userName===y.Name),g={};Object.keys(m).forEach(j=>{g[j]=0}),w.forEach(j=>{j.status==="completed"&&(g[j.type]=(g[j.type]||0)+j.amount)});const E=Object.values(g).reduce((j,L)=>j+L,0);s+=`"${y.Name}","${y.Team||"ไม่ระบุ"}"`,Object.keys(m).forEach(j=>{const L=g[j];s+=`,"${L>0?L.toLocaleString():"0"}"`}),s+=`,"${E.toLocaleString()}"\r
`}),s+=`\r
`),s+=`สรุปการใช้สวัสดิการแยกตามประเภท\r
`,s+=`ประเภทสวัสดิการ,จำนวนคำร้อง (รายการ),ยอดเงินที่ใช้ไป (บาท)\r
`,x.forEach(n=>{s+=`"${m[n.type]||n.type}","${n.count.toLocaleString()}","${n.used.toLocaleString()}"\r
`}),s+=`\r
สรุปสถานะคำร้อง\r
`,s+=`สถานะการอนุมัติ,จำนวนคำร้อง (รายการ)\r
`,c.forEach(n=>{s+=`"${n.label}","${n.count.toLocaleString()}"\r
`}),s+=`\r
สรุปการใช้สวัสดิการตามแผนก\r
`,s+=`ชื่อแผนก,จำนวนคำร้อง (รายการ),ยอดเงินที่ใช้ไป (บาท)\r
`,i.forEach(n=>{s+=`"${n.department}","${n.count.toLocaleString()}","${n.used.toLocaleString()}"\r
`}),s+=`\r
รายละเอียดคำร้องทั้งหมด\r
`,s+=`วันที่ยื่นคำร้อง,รหัสคำร้อง,ชื่อพนักงาน,แผนก,ประเภทสวัสดิการ,จำนวนเงิน (บาท),สถานะ,หมายเหตุ\r
`,v.forEach(n=>{var y;s+=`"${new Date(n.date).toLocaleDateString("th-TH")}","${n.id||"ไม่ระบุ"}","${n.userName}","${n.userDepartment||"ไม่ระบุ"}","${m[n.type]||n.type}","${n.amount.toLocaleString()}","${((y=c.find(w=>w.status===n.status))==null?void 0:y.label)||n.status}","${n.description||"ไม่มี"}"\r
`});const l="\uFEFF"+s,b=new Blob([l],{type:"text/csv;charset=utf-8;"}),o=u!=null&&u.from&&(u!=null&&u.to)?`${u.from.toISOString().slice(0,10)}_${u.to.toISOString().slice(0,10)}`:new Date().toISOString().slice(0,10);Te.saveAs(b,`welfare_report_${o}.csv`)}const Me=()=>{var R,Z;const x=we(),{welfareRequests:c}=Se(),[i,m]=h.useState(null),[v,p]=h.useState("all"),[r,f]=h.useState("all"),[u,s]=h.useState("all"),[l,b]=h.useState("all"),[o,n]=h.useState([]),[y,w]=h.useState(!1),[g,E]=h.useState(null),[j,L]=h.useState([]);h.useEffect(()=>{async function t(){try{const a=await $e();n(a);const d=Array.from(new Set(a.map($=>$.Team).filter(Boolean)));L(d)}catch(a){console.error("Error loading employees:",a)}}t()},[]);const S=h.useMemo(()=>c.filter(t=>{if(v!=="all"&&t.type!==v||r!=="all"&&t.userDepartment!==r||u!=="all"&&t.status!==u)return!1;if(l!=="all"){const a=o.find(d=>d.id.toString()===l);if(!a||t.userName!==a.Name)return!1}if(i!=null&&i.from&&(i!=null&&i.to)){const a=new Date(t.date),d=new Date(i.from);d.setHours(0,0,0,0);const $=new Date(i.to);if($.setHours(23,59,59,999),a<d||a>$)return!1}return!0}),[c,v,r,u,l,i]),k=h.useMemo(()=>{const t={};return Object.keys(D).forEach(d=>{t[d]={count:0,used:0,remaining:1e5}}),S.forEach(d=>{t[d.type]&&(t[d.type].count++,d.status==="completed"&&(t[d.type].used+=d.amount))}),Object.keys(t).forEach(d=>{t[d].remaining=1e5-t[d].used}),Object.entries(t).map(([d,$])=>({type:d,...$}))},[S]),W=h.useMemo(()=>{const t={pending_manager:0,pending_hr:0,pending_accounting:0,completed:0,rejected_manager:0,rejected_hr:0,rejected_accounting:0};return S.forEach(a=>{t[a.status]++}),[{status:"pending_manager",count:t.pending_manager,label:"รอผู้จัดการอนุมัติ"},{status:"pending_hr",count:t.pending_hr,label:"รอ HR อนุมัติ"},{status:"pending_accounting",count:t.pending_accounting,label:"รอฝ่ายบัญชีตรวจสอบ"},{status:"completed",count:t.completed,label:"อนุมัติแล้ว"},{status:"rejected_manager",count:t.rejected_manager,label:"ผู้จัดการไม่อนุมัติ"},{status:"rejected_hr",count:t.rejected_hr,label:"HR ไม่อนุมัติ"},{status:"rejected_accounting",count:t.rejected_accounting,label:"ฝ่ายบัญชีไม่อนุมัติ"}]},[S]),K=h.useMemo(()=>{const t={};return S.forEach(a=>{const d=a.userDepartment||"ไม่ระบุแผนก";t[d]||(t[d]={count:0,used:0}),t[d].count++,a.status==="completed"&&(t[d].used+=a.amount)}),Object.entries(t).map(([a,d])=>({department:a,...d}))},[S]),[z,A]=h.useState(null);h.useEffect(()=>{(async()=>{if(l==="all"){A(null);return}const a=o.find(d=>d.id.toString()===l);if(!a){A(null);return}try{const d=await Fe(a.id);A(d)}catch{A(null)}})()},[l,o]);const X=h.useMemo(()=>z?z.map(t=>({type:t.type,label:D[t.type]||t.type,limit:t.totalLimit,used:t.used,remaining:t.remaining,percent:t.totalLimit>0?Math.round(t.used/t.totalLimit*100):0})):null,[z]),T={wedding:"#FF6F61",training:"#6A5ACD",childbirth:"#FFD700",funeral:"#20B2AA",glasses:"#FF69B4",dental:"#40E0D0",fitness:"#FF8C00",medical:"#43A047"},te={labels:k.map(t=>D[t.type]||t.type),datasets:[{label:"ยอดใช้ไป (บาท)",data:k.map(t=>t.used),backgroundColor:k.map(t=>T[t.type]||"#3b82f6"),borderColor:k.map(t=>T[t.type]||"#3b82f6"),borderWidth:2,borderRadius:8,borderSkipped:!1}]},se={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{font:{size:14,weight:"bold"},color:"#374151"}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#fff",bodyColor:"#fff",borderColor:"#e5e7eb",borderWidth:1,cornerRadius:8,displayColors:!0,callbacks:{label:function(t){return`${t.dataset.label}: ${Number(t.parsed.y).toLocaleString()} บาท`}}}},scales:{x:{grid:{display:!1},ticks:{font:{size:12,weight:"normal"},color:"#6b7280"}},y:{beginAtZero:!0,grid:{color:"#f3f4f6",lineWidth:1},ticks:{font:{size:12},color:"#6b7280",callback:function(t){return Number(t).toLocaleString()+" บาท"}}}},elements:{bar:{borderRadius:8,borderSkipped:!1}}},ae=k.reduce((t,a)=>t+a.used,0),le=S.length,ne=S.filter(t=>t.status==="completed").length,re=S.filter(t=>t.status.includes("pending")).length,ie=S.filter(t=>t.status.includes("rejected")).length,oe={labels:["อนุมัติแล้ว","รอดำเนินการ","ไม่อนุมัติ"],datasets:[{data:[ne,re,ie],backgroundColor:["#10B981","#F59E0B","#EF4444"],borderWidth:0,cutout:"70%"}]},ce={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{font:{size:12},color:"#374151",usePointStyle:!0,padding:20}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#fff",bodyColor:"#fff",borderColor:"#e5e7eb",borderWidth:1,cornerRadius:8}}};return e.jsx("div",{className:"min-h-screen bg-gray-50 py-10 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto rounded-2xl shadow-lg bg-white p-6 md:p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8 flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(G,{variant:"ghost",onClick:()=>x("/admin"),children:"← ย้อนกลับ"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800 drop-shadow",children:"ภาพรวมสวัสดิการ"}),e.jsx("p",{className:"text-gray-600",children:"รายงานและสถิติการใช้งานสวัสดิการของบริษัท"})]})]}),e.jsxs(G,{variant:"outline",className:"flex items-center gap-2",disabled:!(i!=null&&i.from)||!(i!=null&&i.to),onClick:()=>Oe({summaryByType:k,statusSummary:W,departmentSummary:K,welfareTypeLabels:D,filteredRequests:S,employees:o,departmentFilter:r,employeeFilter:l,dateRange:i}),children:[e.jsx(Le,{className:"w-4 h-4"}),"ดาวน์โหลดรายงาน",(!(i!=null&&i.from)||!(i!=null&&i.to))&&e.jsx("span",{className:"text-xs text-gray-500 ml-1",children:"(เลือกช่วงเวลาก่อน)"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[e.jsx(_,{className:"bg-gradient-to-br from-green-500 to-green-600 border-0 text-white shadow-lg",children:e.jsx(C,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-sm font-medium",children:"ใช้ไปแล้ว"}),e.jsx("p",{className:"text-2xl font-bold",children:ae.toLocaleString()}),e.jsx("p",{className:"text-xs text-green-100",children:"บาท"})]}),e.jsx("div",{className:"bg-green-400/30 p-3 rounded-full",children:e.jsx(Q,{className:"w-6 h-6"})})]})})}),e.jsx(_,{className:"bg-gradient-to-br from-blue-500 to-blue-600 border-0 text-white shadow-lg",children:e.jsx(C,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-sm font-medium",children:"คำร้องทั้งหมด"}),e.jsx("p",{className:"text-2xl font-bold",children:le}),e.jsx("p",{className:"text-xs text-blue-100",children:"รายการ"})]}),e.jsx("div",{className:"bg-blue-400/30 p-3 rounded-full",children:e.jsx(I,{className:"w-6 h-6"})})]})})}),e.jsx(_,{className:"bg-gradient-to-br from-purple-500 to-purple-600 border-0 text-white shadow-lg",children:e.jsx(C,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-sm font-medium",children:"พนักงานที่ใช้"}),e.jsx("p",{className:"text-2xl font-bold",children:new Set(S.map(t=>t.userName)).size}),e.jsx("p",{className:"text-xs text-purple-100",children:"คน"})]}),e.jsx("div",{className:"bg-purple-400/30 p-3 rounded-full",children:e.jsx(V,{className:"w-6 h-6"})})]})})})]}),e.jsxs(_,{className:"mb-8",children:[e.jsx(F,{children:e.jsxs(B,{className:"flex items-center gap-2 text-lg",children:[e.jsx(Ee,{className:"w-5 h-5"})," ตัวกรองข้อมูล"]})}),e.jsx(C,{children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 items-center",children:[e.jsxs(M,{value:r,onValueChange:f,children:[e.jsx(H,{children:e.jsx(U,{placeholder:"เลือกแผนก"})}),e.jsxs(P,{children:[e.jsx(N,{value:"all",children:"ทุกแผนก"}),j.map(t=>e.jsx(N,{value:t,children:t},t))]})]}),e.jsxs(M,{value:l,onValueChange:b,children:[e.jsx(H,{children:e.jsx(U,{placeholder:"เลือกพนักงาน"})}),e.jsxs(P,{children:[e.jsx(N,{value:"all",children:"พนักงานทุกคน"}),o.filter(t=>r==="all"||t.Team===r).map(t=>e.jsx(N,{value:t.id.toString(),children:t.Name||`ID: ${t.id}`},t.id))]})]}),e.jsxs(M,{value:v,onValueChange:p,children:[e.jsx(H,{children:e.jsx(U,{placeholder:"ประเภทสวัสดิการ"})}),e.jsxs(P,{children:[e.jsx(N,{value:"all",children:"ทุกประเภท"}),Object.entries(D).map(([t,a])=>e.jsx(N,{value:t,children:a},t))]})]}),e.jsxs(M,{value:u,onValueChange:s,children:[e.jsx(H,{children:e.jsx(U,{placeholder:"สถานะ"})}),e.jsxs(P,{children:[e.jsx(N,{value:"all",children:"ทุกสถานะ"}),e.jsx(N,{value:"pending_manager",children:"รอผู้จัดการอนุมัติ"}),e.jsx(N,{value:"pending_hr",children:"รอ HR อนุมัติ"}),e.jsx(N,{value:"pending_accounting",children:"รอฝ่ายบัญชีตรวจสอบ"}),e.jsx(N,{value:"completed",children:"อนุมัติแล้ว"}),e.jsx(N,{value:"rejected_manager",children:"ผู้จัดการไม่อนุมัติ"}),e.jsx(N,{value:"rejected_hr",children:"HR ไม่อนุมัติ"}),e.jsx(N,{value:"rejected_accounting",children:"ฝ่ายบัญชีไม่อนุมัติ"})]})]}),e.jsx(De,{value:i,onChange:m})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[e.jsxs(_,{className:"lg:col-span-2",children:[e.jsx(F,{children:e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-5 h-5"}),"สรุปการใช้สวัสดิการแยกตามประเภท"]})}),e.jsx(C,{children:e.jsx("div",{className:"h-96",children:e.jsx(_e,{data:te,options:se})})})]}),e.jsxs(_,{children:[e.jsx(F,{children:e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5"}),"สถานะคำร้อง"]})}),e.jsxs(C,{children:[e.jsx("div",{className:"h-64 mb-4",children:e.jsx(Ce,{data:oe,options:ce})}),e.jsx("div",{className:"space-y-2",children:W.filter(t=>t.count>0).map(t=>e.jsxs("div",{className:"flex justify-between items-center p-2 rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t.label}),e.jsx("span",{className:"font-bold text-blue-600 cursor-pointer hover:text-blue-700 transition-colors",onClick:()=>{t.count>0&&(E(t.status),w(!0))},role:"button",tabIndex:0,style:{userSelect:"none"},children:t.count.toLocaleString()})]},t.status))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs(_,{children:[e.jsx(F,{children:e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5"}),"สรุปตามแผนก"]})}),e.jsx(C,{children:e.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:K.map((t,a)=>e.jsxs("div",{className:"flex justify-between items-center p-3 rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center text-white text-sm font-bold",children:a+1}),e.jsx("span",{className:"text-gray-700 font-medium",children:t.department})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-gray-900 font-bold",children:[t.used.toLocaleString()," บาท"]}),e.jsxs("div",{className:"text-gray-500 text-sm",children:[t.count," รายการ"]})]})]},t.department))})})]}),e.jsxs(_,{children:[e.jsx(F,{children:e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"w-5 h-5"}),"ประเภทสวัสดิการยอดนิยม"]})}),e.jsx(C,{children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:k.sort((t,a)=>a.used-t.used).slice(0,8).map(t=>e.jsxs("div",{className:"p-3 rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:T[t.type]||"#3b82f6"}}),e.jsx("span",{className:"text-gray-700 text-sm font-medium truncate",children:D[t.type]||t.type})]}),e.jsx("div",{className:"text-gray-900 font-bold text-lg",children:t.used.toLocaleString()}),e.jsxs("div",{className:"text-gray-500 text-xs",children:[t.count," รายการ"]})]},t.type))})})]})]}),y&&g&&e.jsx(Be,{open:y,onClose:()=>w(!1),children:e.jsxs("div",{className:"p-6 w-full max-w-4xl bg-white rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["รายการคำร้องสถานะ ",((R=W.find(t=>t.status===g))==null?void 0:R.label)||g]}),e.jsx("button",{onClick:()=>w(!1),className:"text-gray-500 hover:text-red-500 text-2xl transition-colors",children:"✕"})]}),e.jsx("div",{className:"overflow-y-auto max-h-[70vh]",children:(()=>{const t=S.filter(a=>a.status===g);return t.length===0?e.jsxs("div",{className:"text-center text-gray-400 py-20",children:[e.jsx(I,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg",children:"ไม่พบรายการคำร้อง"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white rounded-lg overflow-hidden border",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-4 text-left text-gray-900 font-semibold",children:"วันที่"}),e.jsx("th",{className:"py-3 px-4 text-left text-gray-900 font-semibold",children:"ชื่อพนักงาน"}),e.jsx("th",{className:"py-3 px-4 text-left text-gray-900 font-semibold",children:"ประเภท"}),e.jsx("th",{className:"py-3 px-4 text-right text-gray-900 font-semibold",children:"จำนวนเงิน"}),e.jsx("th",{className:"py-3 px-4 text-left text-gray-900 font-semibold",children:"แผนก"})]})}),e.jsx("tbody",{children:t.map((a,d)=>e.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4 text-gray-700",children:new Date(a.date).toLocaleDateString("th-TH")}),e.jsx("td",{className:"py-3 px-4 text-gray-900 font-medium",children:a.userName}),e.jsx("td",{className:"py-3 px-4 text-gray-700",children:D[a.type]||a.type}),e.jsxs("td",{className:"py-3 px-4 text-right text-green-600 font-bold",children:[Number(a.amount).toLocaleString()," บาท"]}),e.jsx("td",{className:"py-3 px-4 text-gray-700",children:a.userDepartment||"-"})]},a.id||d))})]})})})()})]})}),l!=="all"&&X&&e.jsxs(_,{children:[e.jsx(F,{children:e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5"}),"สรุปสวัสดิการของ ",((Z=o.find(t=>t.id.toString()===l))==null?void 0:Z.Name)||""]})}),e.jsx(C,{children:e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200 shadow-sm bg-white p-4",children:e.jsxs("table",{className:"min-w-full text-base text-gray-700",children:[e.jsx("thead",{className:"bg-blue-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"font-semibold text-blue-700 text-base py-3 px-2 text-left",children:"ประเภทสวัสดิการ"}),e.jsx("th",{className:"font-semibold text-blue-700 text-base py-3 px-2 text-right",children:"วงเงินทั้งหมด"}),e.jsx("th",{className:"font-semibold text-blue-700 text-base py-3 px-2 text-right",children:"ใช้ไปแล้ว"}),e.jsx("th",{className:"font-semibold text-blue-700 text-base py-3 px-2 text-right",children:"คงเหลือ"}),e.jsx("th",{className:"w-[200px] font-semibold text-blue-700 text-base py-3 px-2 text-center",children:"สัดส่วนการใช้"})]})}),e.jsx("tbody",{children:X.map(t=>{t.limit>0&&t.remaining/t.limit*100;const a=t.limit>0?t.used/t.limit*100:0;return e.jsxs("tr",{className:"border-b border-gray-200 hover:bg-blue-50/50 transition-colors",children:[e.jsxs("td",{className:"font-medium flex items-center gap-3 py-4 px-2",children:[e.jsx("span",{className:"inline-block w-4 h-4 rounded-full shadow-lg",style:{background:T[t.type]||"#3b82f6"}}),e.jsx("span",{className:"text-gray-900 text-base",children:t.label})]}),e.jsxs("td",{className:"text-right px-2 text-gray-700",children:[t.limit.toLocaleString(),e.jsx("span",{className:"text-xs text-gray-400 ml-1",children:"บาท"})]}),e.jsxs("td",{className:"text-right px-2 text-green-600 font-semibold",children:[t.used.toLocaleString(),e.jsx("span",{className:"text-xs text-gray-400 ml-1",children:"บาท"})]}),e.jsxs("td",{className:"text-right px-2 text-blue-600 font-semibold",children:[t.remaining.toLocaleString(),e.jsx("span",{className:"text-xs text-gray-400 ml-1",children:"บาท"})]}),e.jsxs("td",{className:"text-center px-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-4 overflow-hidden shadow-inner",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-500 shadow-sm",style:{width:`${a}%`,background:`linear-gradient(90deg, ${T[t.type]||"#3b82f6"}, ${T[t.type]||"#3b82f6"}dd)`}})}),e.jsxs("span",{className:"text-gray-900 font-bold text-sm w-12 text-right",children:[Math.round(a),"%"]})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"ใช้ไปแล้ว"})]})]},t.type)})})]})})})]})]})})};export{Me as default};
