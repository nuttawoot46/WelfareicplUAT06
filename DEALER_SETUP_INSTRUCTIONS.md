# ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Dealer Dropdown

## ‚ö†Ô∏è ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏Å‡πà‡∏≠‡∏ô

### 1. ‡∏£‡∏±‡∏ô Migration ‡πÉ‡∏ô Supabase SQL Editor

1. ‡πÄ‡∏õ‡∏¥‡∏î Supabase Dashboard
2. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà SQL Editor
3. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå `run_dealer_migrations.sql`
4. ‡∏ß‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏î Run

‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ô‡∏µ‡πâ:

```sql
-- Create table
CREATE TABLE IF NOT EXISTS public.data_dealer (
  "No." text NULL,
  "Name" text NULL
);

-- Enable RLS
ALTER TABLE public.data_dealer ENABLE ROW LEVEL SECURITY;

-- Create policies
CREATE POLICY "Allow authenticated users to read dealer data"
ON public.data_dealer FOR SELECT TO authenticated USING (true);

CREATE POLICY "Allow service role to manage dealer data"
ON public.data_dealer FOR ALL TO service_role USING (true) WITH CHECK (true);

-- Create RPC function
CREATE OR REPLACE FUNCTION public.get_dealer_list()
RETURNS TABLE("No." text, "Name" text)
LANGUAGE sql SECURITY DEFINER
AS $$
  SELECT "No.", "Name"
  FROM public.data_dealer
  ORDER BY "Name" ASC NULLS LAST;
$$;

-- Grant permissions
GRANT EXECUTE ON FUNCTION public.get_dealer_list() TO authenticated;
```

### 2. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Dealer

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• dealer:

```sql
INSERT INTO public.data_dealer ("No.", "Name") VALUES
('001', '‡∏î‡∏µ‡∏•‡πÄ‡∏•‡∏≠‡∏£‡πå A'),
('002', '‡∏î‡∏µ‡∏•‡πÄ‡∏•‡∏≠‡∏£‡πå B'),
('003', '‡∏î‡∏µ‡∏•‡πÄ‡∏•‡∏≠‡∏£‡πå C');
```

### 3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á

```sql
-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
SELECT * FROM public.data_dealer;

-- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö RPC function
SELECT * FROM get_dealer_list();
```

## ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö

1. **‡∏ñ‡πâ‡∏≤‡∏£‡∏±‡∏ô migration ‡πÅ‡∏•‡πâ‡∏ß**: ‡∏à‡∏∞‡πÉ‡∏ä‡πâ RPC function `get_dealer_list()` ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
2. **‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ô migration**: ‡∏à‡∏∞‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á
3. **‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ï‡∏≤‡∏£‡∏≤‡∏á**: dropdown ‡∏à‡∏∞‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤ (‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏")

## Console Logs

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏ü‡∏≠‡∏£‡πå‡∏° ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô log ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

- `üîç Fetching dealer list...` - ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
- `‚úÖ Dealer list loaded via RPC: X dealers` - ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏ú‡πà‡∏≤‡∏ô RPC
- `‚ö†Ô∏è RPC function not available, trying direct query` - RPC ‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏° ‡∏•‡∏≠‡∏á‡∏î‡∏∂‡∏á‡∏ï‡∏£‡∏á
- `‚úÖ Dealer list loaded via direct query: X dealers` - ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏ï‡∏£‡∏á
- `‚ö†Ô∏è Dealer table not available` - ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ï‡∏≤‡∏£‡∏≤‡∏á

## ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: 404 Not Found
- **‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏**: ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ô migration
- **‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ**: ‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á SQL ‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô‡πÉ‡∏ô Supabase SQL Editor

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Dropdown ‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤
- **‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏**: ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
- **‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ**: INSERT ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• dealer ‡∏ï‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Permission Denied
- **‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏**: RLS policies ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- **‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ**: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏£‡∏±‡∏ô CREATE POLICY ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á 2 policies
